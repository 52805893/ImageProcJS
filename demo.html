<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ImageProcJS</title>
    <style>
        svg{
            background:#ffffff;
            border: 1px solid;
        }

        rect {
            fill: none;
            pointer-events: all;
        }

        circle,
        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 1.5px;
        }

        circle {
            fill: #fff;
            fill-opacity: .2;
            cursor: move;
        }

        .selected {
            fill: #ff7f0e;
            stroke: #ff7f0e;
        }
    </style>

	<!-- External libraries -->
    <script type="text/javascript" src="jquery-1.10.2.min.js"></script>
	<script type="text/javascript" src="d3.v3.min.js"></script>
	
	<!-- Peihong's library -->
    <script type="text/javascript" src="mathutils.js"></script>
	<script type="text/javascript" src="color.js"></script>
	<script type="text/javascript" src="image.js"></script>
	<script type="text/javascript" src="filter.js"></script>
	<script type="text/javascript" src="curve.js"></script>
	<script type="text/javascript" src="tools/curvetool.js"></script>
	<script type="text/javascript" src="imageloader.js"></script>
	<script type="text/javascript" src="utils.js"></script>
	<script>
		var context, canvas;
        var curvetool;
		var loader;
		window.onload = function() {
            loader = new ImageLoader();
			canvas = document.getElementById('cvs');
			context = canvas.getContext('2d');
            curvetool = new CurveTool();
            curvetool.initCurveTool('#div_curvetool');

            $(document).on("curvechanged", function(evt) {
               console.log('curve changed.');

                var I = loader.result;
                I = filters.curve(I, curvetool.getLUT(), $('#channelselect').val());
                I.render(canvas);
            });

            $('#resetcurve_btn').click(function() {
                curvetool.resetCurveTool();
                var I = loader.result;
                I.render(canvas);
            });
			
			$('#show_btn').click( function() {
                loader.loadImage('seal.jpg', canvas);
			});
			
			$('#gs_btn').click( function() {
                var I = loader.result;
				I = filters.grayscale(I);
				I.render(canvas);
			});

            $('#hist_btn').click(function() {
                var I = loader.result;
                I = filters.histogram(I);
                I.render(canvas);
            });

            $('#ahe_btn').click(function() {
                var I = loader.result;
                I = filters.ahe(I);
                I.render(canvas);
            });

            $('#brightnessbar').change( function() {
                var beta = parseInt($('#brightnessbar').val());
                $('#brightnessval').html(beta);
                var I = loader.result;

                if( $('#brightnesscontrast').is(':checked') ){
                    var alpha = parseInt($('#contrastbar').val());
                    I = filters.brightnesscontrast(I, alpha, beta);
                }else {
                    I = filters.brightness(I, beta);
                }
                I.render(canvas);
            });

            $('#contrastbar').change( function() {
                var alpha = parseInt($('#contrastbar').val());
                $('#contrastval').html(alpha);
                var I = loader.result;
                if( $('#brightnesscontrast').is(':checked') ){
                    var beta = parseInt($('#brightnessbar').val());
                    I = filters.brightnesscontrast(I, alpha, beta);
                }else{
                    I = filters.contrast(I, alpha);
                }
                I.render(canvas);
            });
			
			$('#files').change( function( e ){
				handleFileSelect(e, loader, canvas);
			});
		}
	</script>
</head>
<body>
<button id="show_btn">Show Remote Image</button>
<div>
<table>
    <tr>
        <td><button id="gs_btn">Show Grayscale</button></td>
    </tr>
    <tr>
        <td><button id="hist_btn">Histogram Equalization</button></td>
    </tr>
    <tr>
        <td><button id="ahe_btn">Adaptive Histogram Equalization</button></td>
    </tr>
    <tr>
        <td><input type="checkbox" id="brightnesscontrast">Brightness & Contrast</td>
    </tr>
    <tr>
        <td><input type="range" id="brightnessbar" min="-128" max="128" value="0">Brightness</td><td><p id="brightnessval"></p></td>
    </tr>
    <tr>
        <td><input type="range" id="contrastbar" min="-128" max="128" value="0">Contrast</td><td><p id="contrastval"></p></td>
    </tr>
</table>
</div>
Upload image:
<input type="file" id="files" name="files[]" />
<output id="list"></output>

<p id='imageinfo'></p>
<div>
    <div>
        <canvas id="cvs"></canvas>
    </div>
    <div id='div_curvetool'>
        <button id="resetcurve_btn">Reset Curve</button>
        <select id="channelselect">
            <option value="brightness">Brightness</option>
            <option value="red">Red</option>
            <option value="green">Green</option>
            <option value="blue">Blue</option>
        </select><br>
    </div>
</div>
</body>
</html>